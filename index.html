<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SÄ°STEM Ä°MHASI</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { 
            width: 100%; height: 100%; overflow: hidden; background: #000;
            font-family: 'Courier New', monospace; pointer-events: none; 
        }

        canvas { position: fixed; top: 0; left: 0; z-index: 1; opacity: 0.8; }

        #ui-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 100; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background: rgba(0, 0, 0, 0.9); color: #ff0000; text-align: center;
        }

        .terminal {
            border: 6px double #f00; padding: 25px; background: #050000;
            box-shadow: 0 0 100px #f00; width: 92%;
            animation: vibe 0.05s infinite; pointer-events: auto;
        }

        /* YÃ¼kleme Ã‡ubuÄŸu */
        #loader-container { width: 100%; background: #222; height: 10px; margin: 15px 0; display: none; }
        #loader-bar { width: 0%; height: 100%; background: #f00; }

        #target-data {
            text-align: left; font-size: 0.85rem; color: #0f0; 
            margin-bottom: 15px; border-bottom: 1px solid #0f0; 
            padding-bottom: 10px; display: none;
        }

        #timer { font-size: 25vw; font-weight: bold; text-shadow: 0 0 30px #f00; }

        button {
            background: #f00; color: #fff; border: 4px solid #fff;
            padding: 15px 30px; font-size: 1.2rem; font-weight: bold;
            margin-top: 15px; pointer-events: auto;
        }

        @keyframes vibe {
            0% { transform: translate(1px, 1px); }
            50% { transform: translate(-2px, -1px) scale(1.01); }
            100% { transform: translate(1px, -1px); }
        }

        #blocker { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99999; display: none; pointer-events: auto; }
    </style>
</head>
<body oncontextmenu="return false;">

<canvas id="matrix"></canvas>
<div id="blocker"></div>

<div id="ui-layer">
    <div class="terminal">
        <div id="status-title">> SÄ°STEM ERÄ°ÅžÄ°MÄ° BEKLENÄ°YOR...</div>
        
        <div id="loader-container"><div id="loader-bar"></div></div>

        <div id="target-data">
            IP: <span id="ip">SORGULANIYOR...</span><br>
            CIHAZ: <span id="device">ANALIZ...</span><br>
            MARKA: <span id="brand">TESPIT...</span>
        </div>

        <div id="timer">15</div>
        <p id="sub-text" style="color:#fff; font-size: 0.8rem;">Ä°MHAYI DURDURMAK Ä°Ã‡Ä°N BUTONA BASIN</p>
        <button id="main-btn" onclick="ignite()">ERÄ°ÅžÄ°MÄ° DURDUR</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('matrix');
    const ctx = canvas.getContext('2d');
    const timerEl = document.getElementById('timer');
    const loaderContainer = document.getElementById('loader-container');
    const loaderBar = document.getElementById('loader-bar');
    const targetData = document.getElementById('target-data');
    const statusTitle = document.getElementById('status-title');
    const blocker = document.getElementById('blocker');
    
    let audioCtx;
    let timeLeft = 15;
    let escapeCheck;

    // 1. IP VE CÄ°HAZ (Ã–nceden hazÄ±rla)
    async function prepareIntel() {
        const res = await fetch('https://api.ipify.org?format=json').catch(()=>({json:()=>({ip:"192.168.1.104"})}));
        const data = await res.json();
        document.getElementById('ip').innerText = data.ip;

        const ua = navigator.userAgent;
        document.getElementById('device').innerText = /Android/i.test(ua) ? "Android Terminal" : "iOS Terminal";
        document.getElementById('brand').innerText = /Samsung/i.test(ua) ? "Samsung Knox" : (/iPhone/i.test(ua) ? "Apple A-Series" : "Generic Mobile");
    }
    prepareIntel();

    // 2. KONTROL SÄ°STEMÄ° (KaÃ§Ä±ÅŸ Engelleyici)
    if(localStorage.getItem('br_active')) {
        timeLeft = parseInt(localStorage.getItem('br_time')) || 15;
        alert("KAÃ‡IÅž GÄ°RÄ°ÅžÄ°MÄ° TESPÄ°T EDÄ°LDÄ°! PROTOKOL SIFIRLANAMAZ.");
        ignite(); 
    }

    // 3. MATRIX YAÄžMURU
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const chars = "ERROR_VOID_666_SYSTEM_FAILURE";
    const drops = Array(Math.floor(canvas.width / 20)).fill(1);
    function draw() {
        ctx.fillStyle = "rgba(0,0,0,0.1)"; ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = "#f00"; ctx.font = "20px monospace";
        drops.forEach((y, i) => {
            ctx.fillText(chars[Math.floor(Math.random()*chars.length)], i*20, y*20);
            if(y*20 > canvas.height && Math.random() > 0.975) drops[i]=0;
            drops[i]++;
        });
    }
    setInterval(draw, 35);

    // 4. SES SÄ°STEMÄ° (KorkunÃ§ GÃ¼lme ve Siren)
    function playSounds() {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // Siren
        const s = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        s.type = 'sawtooth'; s.frequency.setValueAtTime(200, audioCtx.currentTime);
        s.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 1);
        g.gain.setValueAtTime(0.2, audioCtx.currentTime);
        s.connect(g); g.connect(audioCtx.destination);
        s.start();

        // Sahte "KorkunÃ§ GÃ¼lme" (Frekans SÄ±Ã§ramalarÄ±yla)
        setInterval(() => {
            if(timeLeft < 10) {
                const laugh = audioCtx.createOscillator();
                laugh.type = 'square';
                laugh.frequency.setValueAtTime(Math.random()*200 + 50, audioCtx.currentTime);
                const lg = audioCtx.createGain();
                lg.gain.setValueAtTime(0.1, audioCtx.currentTime);
                laugh.connect(lg); lg.connect(audioCtx.destination);
                laugh.start(); laugh.stop(audioCtx.currentTime + 0.2);
            }
        }, 300);
    }

    // 5. ANA TUZAK FONKSÄ°YONU
    function ignite() {
        playSounds();
        document.getElementById('main-btn').style.display = 'none';
        loaderContainer.style.display = 'block';
        blocker.style.display = 'block';
        localStorage.setItem('br_active', 'true');
        if(document.documentElement.requestFullscreen) document.documentElement.requestFullscreen();

        let loadPercent = 0;
        const mainLoop = setInterval(() => {
            // Ä°lk 5 saniye yÃ¼kleme Ã§ubuÄŸu
            if(loadPercent < 100) {
                loadPercent += 2;
                loaderBar.style.width = loadPercent + "%";
                statusTitle.innerText = "> VERÄ°LER ELE GEÃ‡Ä°RÄ°LÄ°YOR: %" + loadPercent;
                if(loadPercent >= 100) {
                    targetData.style.display = 'block';
                    statusTitle.innerText = "> SÄ°STEM KONTROLÃœ SAÄžLANDI";
                    statusTitle.style.color = "#0f0";
                }
            }

            timeLeft--;
            timerEl.innerText = timeLeft;
            localStorage.setItem('br_time', timeLeft);

            if(timeLeft % 2 === 0) {
                document.body.style.filter = "invert(1)";
                setTimeout(() => document.body.style.filter = "none", 50);
            }

            if(timeLeft <= 0) {
                clearInterval(mainLoop);
                localStorage.clear();
                showFinal();
            }
        }, 1000);
    }

    function showFinal() {
        if(audioCtx) audioCtx.close();
        blocker.style.display = 'none';
        document.body.style.pointerEvents = 'auto';
        document.body.innerHTML = `
            <div style="background:white; color:black; height:100vh; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:20px;">
                <h1 style="font-size:6rem;">ðŸ¤¡</h1>
                <h1 style="color:green; font-size:2.5rem;">DUR! ÅžAKAYDI!</h1>
                <p>CihazÄ±na hiÃ§bir ÅŸey olmadÄ±, her ÅŸey gÃ¼vende.</p>
                <button onclick="location.reload()" style="background:black; color:white; padding:15px 30px; border:none; margin-top:30px; border-radius:10px;">KURTARILDI</button>
            </div>
        `;
    }

    // Geri tuÅŸu hapsi
    history.pushState(null, null, location.href);
    window.onpopstate = () => history.go(1);

    // ACÄ°L Ã‡IKIÅž (Rakamlara 3 saniye basÄ±lÄ± tut)
    timerEl.addEventListener('touchstart', () => exitTrigger = setTimeout(() => {timeLeft=0; showFinal(); localStorage.clear();}, 3000));
    timerEl.addEventListener('touchend', () => clearTimeout(exitTrigger));
</script>
</body>
</html>
